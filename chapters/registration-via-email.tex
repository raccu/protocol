\section{Register via email}

    \subsection{Flow}
    The flow of registering an account via email (i.e. use an email validation claim) is defined as follows:
        \begin{enumerate}
            \item A user MUST provide a valid name and a valid email.
            \item When Auth receives a valid registration request, it MUST dispatch an email with a verification 
                  code to the provided email.
            \item Upon receiving the verification code and entering it into the Mobile, a Mobile MUST provide a 
                  method to generate, store, and retrieve public key and an interface for signing an arbitrary 
                  message with a matching private key.
            \item Mobile MUST finish an account creation by submitting a name, email, generated public key, and 
                  a digital signature of all of the previous parameters, with the REQUIRED addition of the 
                  verification code, to the Auth.
        \end{enumerate}

    The flow is shown in a following sequence diagram:    
        \input{diagrams/sequence/registration-via-email.tex}

    \subsection{Requirements}
    The following requirements are made for a registration via email:
        \begin{enumerate}
            \item Provided email MUST NOT be associated with another account on Auth.\\
            \textit{Argument:} This is to prove that one user can only have a single account.

            \item Verification code MUST be at least 4 characters long and short lived, and MUST NOT be 
                predictable.\\        
            \textit{Argument:} Verification code should posses a certain entropy and a level of randomness, 
                            just as well as a limited lifetime in order to reduce the likelihood of a 
                            successful brute-force attack.

            \item Verification code MUST NOT be revealed to third parties or sent over the network.\\        
            \textit{Argument:} Verification code represents a shared secret between the entities and revealing 
                            it to other parties or sending it over a (potentially insecure) network poses 
                            a confidentiality breach risk. 

            \item It is RECOMMENDED to reset verification code after a several unsuccessful verification 
                code entries.\\        
            \textit{Argument:} This is to reduce a chance of a successful brute-force attack.

            \item Mobile MUST NOT expose private key directly.\\
            \textit{Argument:} Since the digital signature is a basis of authentication, an utmost respect to 
                            protecting the confidentiality of the private key should be implemented.

            \item Mobile MUST always require a biometric authentication to allow access to digital signing 
                capability.\\        
            \textit{Argument:} This is to avoid phishing attacks or other illegal attempts to get the user's 
                            digital signature without his/hers explicit approval.

            \item Mobile MUST store generated keys in a trusted execution environment (TEE).\\        
            \textit{Argument:} This is to avoid a root attack or other system-level attacks that target storage 
                            memory or execution environment.

            \item The communication between a Mobile and Auth MUST rely on a secure channel that provides 
                confidentiality and verifies integrity. It is RECOMMENDED to use up-to-date version of 
                Transport Level Security (TLS) protocol with a well-tested and computationally secure 
                cipher suite.\\      
            \textit{Argument:} Mobile and Auth exchange user's personal information and transmitting them over a 
                            public channel would pose a privacy concern, as well as create new vectors of attack, 
                            namely social engineering, phishing, and targeted brute-force attacks.
        \end{enumerate}