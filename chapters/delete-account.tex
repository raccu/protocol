\section{Delete account}
In this section a flow for deleting an account of the user is defined. 

    \subsection{Flow}
    Delete account flow is given in Figure~\ref{fig:deleteAccount} and defined as follows:
        \begin{enumerate}
            \item Mobile MUST request a verification code from the Auth by submitting the email address of the user
                  which is trying to delete the account.
            \item Upon receiving a request to delete an account, the Auth MUST dispatch an email with the verification
                  code to the Email.
            \item When the user enters verification code into the Mobile, the Mobile MUST send the email and signature 
                  of the email and verification code to the Auth to complete the process of deleting the account.
        \end{enumerate}
        \input{diagrams/sequence/delete-account.tex}

        \subsection{Requirements}
        The following requirements are made for a credentials reset:
        \begin{enumerate}
                \item Provided email MUST be associated with an account on Auth.\\
                \textit{Argument:} It is trivial that the Auth cannot delete an account it does not have any record of. 
    
                \item Verification code MUST be at least six characters long, contain a character space of at least ten 
                      characters, and be short lived while it MUST NOT be predictable.\\        
                \textit{Argument:} Verification code should posses a certain entropy and a level of randomness, 
                                   just as well as a limited lifetime in order to reduce the likelihood of a 
                                   successful brute-force attack.
    
                \item Verification code MUST NOT be revealed to third parties or sent over the network, except when
                      it's sent to the Email by Auth.\\        
                \textit{Argument:} Verification code represents a shared secret between the entities and revealing 
                                   it to other parties or sending it over a (potentially insecure) network poses 
                                   a confidentiality breach risk. 
    
                \item Verification code MUST be reset after a several unsuccessful verification code entries.\\        
                \textit{Argument:} This is to reduce a chance of a successful brute-force attack.
    
                \item Mobile MUST always require a biometric authentication to allow access to digital signing 
                      capability.\\        
                \textit{Argument:} This is to avoid phishing attacks or other illegal attempts to get the user's 
                                   digital signature without his/hers explicit approval.

                \item User's name, email, public key, and private key MUST be deleted from the Mobile and SHOULD be 
                      deleted from the Auth.\\        
                \textit{Argument:} This is to protect the right to the privacy of the user and their right to control 
                                   their personal information.
    
                \item The communication between the Mobile and Auth MUST rely on a secure channel that provides 
                      confidentiality and verifies integrity. It is RECOMMENDED to use up-to-date version of 
                      TLS protocol with a well-tested and computationally secure cipher suite.\\      
                \textit{Argument:} Mobile and Auth exchange user's personal information and transmitting them over a 
                                   public channel would pose a privacy concern, as well as create new vectors of attack, 
                                   namely social engineering, phishing, and targeted brute-force attacks.
        \end{enumerate}
    
    \subsection{Successful account deletion}
    If account deletion is successful, the Mobile MUST delete any record of user's name, email, public key, and 
    private key. The Auth SHOULD delete any record of user's name, email, public key, and private key.

    \subsection{Unsuccessful account deletion}
    If account deletion fails for any reason related to the protocol, an attempt to delete an account MUST be discarded. 
    It is RECOMMENDED to log an attempt in order to screen a source of multiple invalid requests. Any of the following 
    reasons is considered to be related to the protocol:
        \begin{itemize}
            \item An email is not associated with any account.
            \item Verification code entered into Mobile does not match the expected verification code.
            \item The signature cannot be verified by the associated public key.
            \item The signature is invalid.
        \end{itemize}
    If account deletion fails for any other reason (e.g. network outage), an appropriate message SHOULD be dispatched or 
    left to other protocols for handling, should they offer such capability.
