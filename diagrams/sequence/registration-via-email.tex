\begin{figure}[H]
    \centering
    \begin{sequencediagram}

        \newinst{A}{Email}{}
        \newinst[3]{B}{Mobile}{}
        \newinst[3]{C}{Auth}{}
        
        \tiny
        \begin{call}{B}{POST /verify/email {(email)}}{C}{200 OK {(token)}}\end{call}{B}
        \mess{C}{Send an email {(verification code)}}{A}
        \mess{A}{verification code}{B}
        \begin{call}{B}{POST /register/email {(token, email, PU\textsubscript{k}, Sign{(token\textbar\textbar email\textbar\textbar PU\textsubscript{k}\textbar\textbar verification code)})}}{C}{200 OK}\end{call}{B}

    \end{sequencediagram}
    \caption{Register via email protocol flow.}
    \label{fig:registerViaEmail}
\end{figure}