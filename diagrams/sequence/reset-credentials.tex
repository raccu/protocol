\begin{figure}[H]
    \centering
    \begin{sequencediagram}

        \newinst{A}{Email}{}
        \newinst[3]{B}{Mobile}{}
        \newinst[3]{C}{Auth}{}

        \tiny
        \begin{call}{B}{POST /reset {(email)}}{C}{200 OK}\end{call}{B}
        \mess{C}{Send an email {(verification code)}}{A}
        \mess{A}{verification code}{B}
        \begin{call}{B}{POST /reset/verify {(email, verification code)}}{C}{200 OK {(reset token)}}\end{call}{B}
        \begin{call}{B}{POST /reset/\{reset token\} {(reset token, PU\textsubscript{k}, Sign(reset token \textbar\textbar PU\textsubscript{k}))}}{C}{200 OK (name)}\end{call}{B}

    \end{sequencediagram}
    \caption{Reset credentials protocol flow}
    \label{fig:resetCredentials}
\end{figure}